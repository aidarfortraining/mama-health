import asyncio
from app.database import AsyncSessionLocal, engine, Base
from app.models.exercise import MathProblem, ReadingText, WordList, StroopColor, ExerciseType

STROOP_COLORS = [
    ("красный", "#FF0000"),
    ("синий", "#0000FF"),
    ("зелёный", "#008000"),
    ("жёлтый", "#FFD700"),
    ("чёрный", "#000000"),
]

EXERCISE_TYPES = [
    ("counting", "Счёт вслух", 120, "Считайте вслух от 1 до 120 как можно быстрее"),
    ("arithmetic", "Арифметика", 120, "Решите 50 простых примеров на скорость"),
    ("reading", "Чтение вслух", 180, "Прочитайте текст вслух чётко и внятно"),
    ("stroop", "Тест Струпа", 120, "Назовите ЦВЕТ букв, игнорируя само слово"),
    ("memory", "Запоминание слов", 180, "Запомните слова, затем воспроизведите их"),
]

WORD_CATEGORIES = {
    "животные": ["кошка", "собака", "лошадь", "корова", "птица", "рыба", "медведь", "волк", "лиса", "заяц", "мышь", "слон"],
    "еда": ["хлеб", "молоко", "яблоко", "суп", "каша", "мясо", "сыр", "масло", "яйцо", "картофель", "морковь", "огурец"],
    "дом": ["стол", "стул", "кровать", "шкаф", "окно", "дверь", "лампа", "диван", "зеркало", "ковёр", "полка", "часы"],
    "природа": ["дерево", "цветок", "река", "гора", "солнце", "луна", "облако", "дождь", "снег", "ветер", "трава", "лес"],
}

READING_TEXTS = [
    ("Утро в деревне", """Раннее утро в деревне начинается с пения петухов. Солнце медленно поднимается над горизонтом, окрашивая небо в розовые и золотые тона. Роса блестит на траве, как маленькие бриллианты. Деревенские жители уже проснулись и начинают свои дела. Бабушка выходит покормить кур, дедушка идёт в огород. Воздух свежий и чистый, пахнет цветами и скошенной травой. Птицы поют свои весёлые песни, приветствуя новый день.

    Коровы медленно бредут на пастбище, где их ждёт сочная зелёная трава. Пастух с длинной палкой идёт рядом, напевая старинную песню. Где-то вдалеке слышится лай собаки - это местный пёс охраняет свою территорию. На крыльце дома сидит кошка и умывается лапкой, греясь на утреннем солнышке.

    У колодца собрались женщины с вёдрами. Они набирают холодную чистую воду и обсуждают последние новости. Кто-то жалуется на погоду, кто-то делится рецептом пирогов. Смех и разговоры разносятся по всей деревне. Дети выбегают на улицу играть в прятки и догонялки.

    В огородах кипит работа. Кто-то полет морковь и свёклу, кто-то окучивает картошку. Работа нелёгкая, но приятная. Земля пахнет свежестью, а руки становятся сильными от труда. К обеду все соберутся за большим столом, чтобы отведать вкусный борщ и свежий хлеб с маслом. А после обеда - короткий отдых под тенистым деревом, и снова за работу до вечера."""),
    ("Зимний лес", """Зимний лес стоит тихий и задумчивый. Деревья укрыты белым снегом, словно надели пушистые шубы. Под ногами хрустит снег. Следы зайца ведут в чащу леса. На ветке сидит красногрудый снегирь. Мороз щиплет щёки, но в лесу хорошо и спокойно. Солнечные лучи пробиваются сквозь ветви и рисуют на снегу причудливые узоры. Лёгкий ветерок качает верхушки елей.

    Тишина зимнего леса завораживает. Кажется, что весь мир замер в ожидании чего-то важного. Только изредка слышится стук дятла по дереву или треск ветки под тяжестью снега. Воздух морозный и свежий, дышится легко. Снежинки медленно падают с неба, кружась в невесомом танце.

    Между деревьями видны следы разных зверей. Вот пробежала лиса, оставив цепочку следов. А там прошёл лось, его большие копыта глубоко увязли в снегу. Белка прыгала с ветки на ветку, собирая припасы из своих тайников. Природа живёт своей тихой жизнью даже в самые холодные дни.

    Солнце садится рано зимой. Длинные тени от деревьев ложатся на снег, создавая причудливые узоры. Небо окрашивается в розово-оранжевые цвета. Скоро наступит вечер, и лес погрузится в темноту. Но даже ночью он прекрасен - луна освещает заснеженные поляны, и всё вокруг сверкает, как в сказке. Зимний лес - это особый мир тишины и красоты."""),
    ("Весенний сад", """Весна пришла в наш сад. Яблони и вишни покрылись белыми и розовыми цветами. Пчёлы жужжат, собирая нектар. В воздухе разлит сладкий аромат цветущих деревьев. Птицы вернулись из тёплых краёв и строят гнёзда. Трава зеленеет с каждым днём. На клумбах распустились первые тюльпаны и нарциссы. Всё вокруг радуется теплу и солнцу.

    Сад просыпается после долгой зимы. Почки на деревьях набухают и раскрываются, выпуская молодые листочки. Земля прогревается, и из неё пробиваются первые ростки. Каждый день приносит новые изменения. Вчера ещё не было листьев на кустах, а сегодня они уже зеленеют на солнце.

    Садовники заняты весенними работами. Они обрезают старые ветки, белят стволы деревьев, готовят грядки для посадки овощей. Нужно успеть многое до начала лета. Дети помогают взрослым, таская лейки с водой и собирая прошлогодние листья. Работа спорится, когда все вместе.

    Вечером в саду особенно хорошо. Солнце опускается за горизонт, окрашивая облака в розовый цвет. Птицы поют последние песни перед сном. Аромат цветов становится ещё сильнее. На скамейке под яблоней приятно посидеть, отдыхая после трудового дня. Весенний сад наполняет сердце радостью и надеждой на хорошее лето, богатый урожай и счастливые дни."""),
]

async def seed():
    async with engine.begin() as conn:
        await conn.run_sync(Base.metadata.drop_all)
        await conn.run_sync(Base.metadata.create_all)

    async with AsyncSessionLocal() as db:
        # Exercise types
        for name, desc, duration, instructions in EXERCISE_TYPES:
            et = ExerciseType(name=name, description=desc, duration_seconds=duration, instructions=instructions)
            db.add(et)

        # Stroop colors
        for name, code in STROOP_COLORS:
            db.add(StroopColor(color_name=name, color_code=code))

        # Math problems
        for a in range(1, 21):
            for b in range(1, 21):
                db.add(MathProblem(expression=f"{a} + {b}", answer=a+b, difficulty=1))
                if a >= b:
                    db.add(MathProblem(expression=f"{a} - {b}", answer=a-b, difficulty=1))

        for a in range(2, 11):
            for b in range(2, 11):
                db.add(MathProblem(expression=f"{a} × {b}", answer=a*b, difficulty=2))

        # Word lists
        for category, words in WORD_CATEGORIES.items():
            db.add(WordList(category=category, words=words, difficulty=1))

        # Reading texts
        for title, content in READING_TEXTS:
            word_count = len(content.split())
            db.add(ReadingText(title=title, content=content, word_count=word_count, difficulty=1))

        await db.commit()
        print("✅ Seed data inserted successfully!")

if __name__ == "__main__":
    asyncio.run(seed())
